<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Solicitudes de Reserva - Costa Potrero</title>
    <link rel="stylesheet" href="../css/estilo.css">
    <link rel="stylesheet" href="css/estilo.css">
</head>
<body>
    <!-- Header -->
    <header>
        <div class="logo">
            <h1 class="h1">Costa Potrero</h1>
            <button onclick="cerrarSesion()" class="btn-logout">Cerrar sesión</button>
        </div>
        <nav>
            <ul>
                <li> 
                    <a href="../reservas/disponibilidad.html">Disponibilidad</a>
                    <a href="../reservas/index.html">Listado Reservas</a>
                    <a href="../cabanas/alta.html">Alta Cabaña</a>
                    <a href="../cabanas/index.html">Listado Cabañas</a>
                    <a href="../huespedes/index.html">Listado Huespedes</a>
                    <a href="../pagos/pagos.html">Lista de Pagos</a>
                    <a href="../solicitudes/index.html">Solicitudes</a>
                </li>
            </ul>
        </nav>
    </header>

    <main class="main-content">
        <section class="section-grilla">
            <h2>📋 Solicitudes de Reserva</h2>
            <div id="mensajes"></div>

            <!-- Botón de actualizar -->
            <div style="margin-bottom: 1rem;">
                <button id="btn-actualizar" class="btn-estadisticas">
                    🔄 Actualizar Lista
                </button>
            </div>

            <!-- Tabla de solicitudes -->
            <table>
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Cliente</th>
                        <th>Contacto</th>
                        <th>Cabaña</th>
                        <th>Fechas</th>
                        <th>Precio</th>
                        <th>Estado</th>
                        <th>Fecha Solicitud</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody id="tabla-solicitudes">
                    <tr>
                        <td colspan="9" style="text-align: center; padding: 2rem; color: #6c757d;">
                            <div class="loader"></div>
                            <p>Cargando solicitudes...</p>
                        </td>
                    </tr>
                </tbody>
            </table>
        </section>
    </main>

    <!-- Modal para Aprobar Solicitud -->
    <div id="modal-aprobar-overlay" class="modal-overlay">
        <div class="modal-busqueda">
            <button class="btn-cerrar-modal" id="btn-cerrar-modal-aprobar">×</button>
            <h3>✅ Aprobar Solicitud</h3>
            <div class="modal-content">
                <p><strong>¿Estás seguro de que deseas aprobar esta solicitud?</strong></p>
                <p>Esta acción cambiará el estado de la solicitud a "Aprobada".</p>
                <div class="form-group">
                    <label for="observaciones-aprobar">Observaciones (opcional):</label>
                    <textarea id="observaciones-aprobar" rows="3" placeholder="Observaciones adicionales sobre la aprobación..."></textarea>
                </div>
                <div class="modal-buttons">
                    <button type="button" id="btn-confirmar-aprobar" class="btn-estadisticas" style="background: #28a745;">
                        ✅ Confirmar Aprobación
                    </button>
                    <button type="button" id="btn-cancelar-aprobar" class="btn-estadisticas" style="background: #6c757d;">
                        ❌ Cancelar
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para Rechazar Solicitud -->
    <div id="modal-rechazar-overlay" class="modal-overlay">
        <div class="modal-busqueda">
            <button class="btn-cerrar-modal" id="btn-cerrar-modal-rechazar">×</button>
            <h3>❌ Rechazar Solicitud</h3>
            <div class="modal-content">
                <p><strong>¿Estás seguro de que deseas rechazar esta solicitud?</strong></p>
                <p>Esta acción cambiará el estado de la solicitud a "Rechazada".</p>
                <div class="form-group">
                    <label for="motivo-rechazo">Motivo del rechazo:</label>
                    <textarea id="motivo-rechazo" rows="3" placeholder="Ingresa el motivo del rechazo..." required></textarea>
                </div>
                <div class="modal-buttons">
                    <button type="button" id="btn-confirmar-rechazar" class="btn-estadisticas" style="background: #dc3545;">
                        ❌ Confirmar Rechazo
                    </button>
                    <button type="button" id="btn-cancelar-rechazar" class="btn-estadisticas" style="background: #6c757d;">
                        ❌ Cancelar
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para Eliminar Solicitud -->
    <div id="modal-eliminar-overlay" class="modal-overlay">
        <div class="modal-busqueda">
            <button class="btn-cerrar-modal" id="btn-cerrar-modal-eliminar">×</button>
            <h3>🗑️ Eliminar Solicitud</h3>
            <div class="modal-content">
                <p><strong>⚠️ ¿Estás seguro de que deseas eliminar esta solicitud?</strong></p>
                <p style="color: #dc3545; font-weight: bold;">Esta acción no se puede deshacer y eliminará permanentemente la solicitud del sistema.</p>
                <div class="form-group">
                    <label for="motivo-eliminacion">Motivo de la eliminación (opcional):</label>
                    <textarea id="motivo-eliminacion" rows="3" placeholder="Ingresa el motivo de la eliminación..."></textarea>
                </div>
                <div class="modal-buttons">
                    <button type="button" id="btn-confirmar-eliminar" class="btn-estadisticas" style="background: #dc3545;">
                        🗑️ Confirmar Eliminación
                    </button>
                    <button type="button" id="btn-cancelar-eliminar" class="btn-estadisticas" style="background: #6c757d;">
                        ❌ Cancelar
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        function cerrarSesion() {
            fetch('/logout', { method: 'POST' })
                .then(() => {
                    window.location.href = '/login.html';
                })
                .catch(error => {
                    console.error('Error al cerrar sesión:', error);
                });
        }
    </script>
    <script src="js/index.js"></script>
</body>
</html> 