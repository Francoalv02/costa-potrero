<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reservas - Administraci√≥n</title>
    <link rel="stylesheet" href="../css/estilo.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
    <script type="module" src="./js/index.js"></script>
</head>
<body>
    <header>
        <div class="logo">
            <h1 class="h1">Costa Potrero</h1>
            <button onclick="cerrarSesion()" class="btn-logout">Cerrar sesi√≥n</button>
        </div>
        <nav>
            <ul>
                <li> 
                    <a href="./../reservas/disponibilidad.html">Disponibilidad</a>
                    <a href="./../reservas/index.html">Listado Reservas</a>
                    <a href="./../cabanas/alta.html">Alta Caba√±a</a>
                    <a href="./../cabanas/index.html">Listado Caba√±as</a>
                    <a href="./../huespedes/index.html">Listado Huespedes</a>
                    <a href="./../pagos/pagos.html">Lista de Pagos</a>
                    <a href="./../solicitudes/index.html">Solicitudes</a>
                </li>
            </ul>
        </nav>
    </header>

    <!-- Bot√≥n flotante de b√∫squeda -->
    <button id="btn-busqueda-flotante" class="btn-busqueda-flotante" title="Buscar una Reserva">
        <span class="btn-busqueda-texto">üîç Buscar una Reserva</span>
    </button>

    <!-- Ventana emergente de b√∫squeda -->
    <div id="modal-overlay" class="modal-overlay">
        <div class="modal-busqueda">
            <button class="btn-cerrar-modal" id="btn-cerrar-modal">√ó</button>
            <h3>Buscar Reserva</h3>
            <form id="form-buscar-reserva" class="form-busqueda">
                <div class="form-row">
                  <div class="form-col">
                    <label for="tipo_busqueda">Tipo de B√∫squeda</label>
                    <select id="tipo_busqueda" name="tipo_busqueda">
                      <option value="id">Por ID</option>
                      <option value="dni">Por DNI</option>
                      <option value="nombre">Por Nombre</option>
                    </select>
                  </div>
                </div>

                <div class="form-group" id="grupo-buscar-id">
                    <label for="id_reserva">ID de Reserva:</label>
                    <input type="number" id="id_reserva" name="id_reserva" min="1" placeholder="Ej: 1, 2, 3...">
                </div>

                <div class="form-group" id="grupo-buscar-dni" style="display:none;">
                    <label for="dni_buscar">DNI:</label>
                    <input type="text" id="dni_buscar" name="dni_buscar" placeholder="Ej: 30123456">
                </div>

                <div class="form-group" id="grupo-buscar-nombre" style="display:none;">
                    <label for="nombre_buscar">Nombre:</label>
                    <input type="text" id="nombre_buscar" name="nombre_buscar" placeholder="Ej: Juan">
                </div>

                <button type="submit" class="btn-estadisticas">Buscar</button>
            </form>
            <div id="resultado-busqueda" class="resultado-busqueda"></div>
        </div>
    </div>

    <main class="main-content">
        <!-- Secci√≥n 1: Grilla de Reservas con Filtros Integrados -->
        <section class="section-grilla">
        <h1 class="titulo-reservas">Reservas</h1>
        <h2 class="subtitulo-reservas">Listado de Reservas Registradas</h2>

            <!-- Filtros Integrados -->
            <div class="filtros-integrados">
                <div class="filtros-header">
                    <h3>Filtros de B√∫squeda</h3>
                    <button id="btn-toggle-filtros" class="btn-toggle-filtros">‚ñº</button>
                </div>
                
                <div class="filtros-content" id="filtros-content">
                    <div class="filtros-grid">
                        <div class="filtro-grupo">
                            <label for="filtro-fecha-inicio">Fecha de Entrada Desde:</label>
                            <input type="date" id="filtro-fecha-inicio" />
                        </div>

                        <div class="filtro-grupo">
                            <label for="filtro-fecha-fin">Fecha de Entrada Hasta:</label>
                            <input type="date" id="filtro-fecha-fin" />
                        </div>

                        <div class="filtro-grupo">
                            <label for="filtro-estado">Estado:</label>
                            <select id="filtro-estado">
                                <option value="">Todos los estados</option>
                            </select>
                        </div>

                        <div class="filtro-grupo">
                            <label for="filtro-cabana">Caba√±a:</label>
                            <select id="filtro-cabana">
                                <option value="">Todas las caba√±as</option>
                            </select>
                        </div>

                        <div class="filtro-grupo">
                            <label for="vista-reservas">Vista:</label>
                            <select id="vista-reservas">
                                <option value="todas">Todas las Reservas</option>
                            </select>
                        </div>
                    </div>

                    <div class="filtro-botones">
                        <button id="btn-aplicar-filtros" class="btn-estadisticas">Aplicar Filtros</button>
                        <button id="btn-limpiar-filtros" class="btn-estadisticas" style="background: #6c757d;">Limpiar Filtros</button>
                        <button id="btn-reporte-reservas" class="btn-estadisticas" style="background: #17a2b8;">Generar Reporte</button>
                    </div>

                    <div class="filtro-info">
                        <p id="info-filtros">Mostrando todas las reservas</p>
                    </div>
                </div>
            </div>

            <div id="mensajes"></div>

            <table>
                <thead>
                    <tr>
                        <th>ID Reserva</th>
                        <th>DNI</th>
                        <th>Nombre Hu√©sped</th>
                        <th>gmail</th>
                        <th>Fecha Entrada</th>
                        <th>Fecha Salida</th>
                        <th>Caba√±a</th>
                        <th>Precio Total</th>
                        <th>Estado Reserva</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody id="contenedor-reservas">
                    
                </tbody>
            </table>
        </section>
        
        <!-- Secci√≥n: Estad√≠sticas y Gr√°ficos de Reservas -->
        <section class="section-estadisticas">
            <h2>Estad√≠sticas y Gr√°ficos</h2>
            <div class="estadisticas-container">
                <!-- Tarjetas de resumen -->
                <div class="tarjetas-resumen">
                    <div class="tarjeta">
                        <h3>Total de Reservas</h3>
                        <p id="res-total">0</p>
                    </div>
                    <div class="tarjeta">
                        <h3>Monto Total De Reservas</h3>
                        <p id="res-ingresos">$0</p>
                    </div>

                </div>

                <!-- Gr√°ficos -->
                <div class="graficos-container">
                    <div class="grafico-item">
                        <h3>Reservas por Mes</h3>
                        <canvas id="res-grafico-mes"></canvas>
                    </div>
                    <div class="grafico-item">
                        <h3>Estado de Reservas</h3>
                        <canvas id="res-grafico-estado"></canvas>
                    </div>
                    <div class="grafico-item">
                        <h3>Caba√±as m√°s Reservadas</h3>
                        <canvas id="res-grafico-cabanas"></canvas>
                    </div>
                </div>
        </div>

            <!-- Botones de acci√≥n -->
            <div class="acciones-container">
                <button id="btn-actualizar-res-estadisticas" class="btn-estadisticas">Actualizar Estad√≠sticas</button>
                <button id="btn-exportar-res-estadisticas" class="btn-estadisticas">Exportar Estad√≠sticas (PDF)</button>
            </div>
        </section>
    </main>

   <script>
  function cerrarSesion() {
    fetch('/logout', { method: 'POST' })
      .then(() => {
        window.location.href = '/login.html';
      })
      .catch(error => {
        console.error('Error al cerrar sesi√≥n:', error);
      });
  }
</script>

</body>
</html>
